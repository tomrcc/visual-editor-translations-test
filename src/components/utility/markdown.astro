---
import markdownit from "markdown-it";
import slugify from "slugify";
import RoseyContent from "src/components/utility/roseyContent.astro";
const md = markdownit({ html: true });
const { content, roseyId } = Astro.props;

const generateRoseyID = (text: string) => {
  if (!text) {
    return "";
  }
  const lowerCaseText = text.toLowerCase();
  const formattedText = lowerCaseText.replaceAll(
    /(?:__[*#])|\[(.*?)\]\(.*?\)/gm,
    /$1/
  );
  return slugify(formattedText, { remove: /[.*,:\/]/g });
};
---

{
  ENV_BOOKSHOP_LIVE && content.original ? (
    content.selected_translation === "es" ? (
      <div class="markdown-text" set:html={md.render(content.es_translation)} />
    ) : (
      <div class="markdown-text" set:html={md.render(content.original)} />
    )
  ) : content.original ? (
    <div
      class="markdown-text"
      data-rosey={generateRoseyID(roseyId)}
      set:html={md.render(content.original)}
    />
  ) : (
    <div
      class="markdown-text"
      data-rosey={generateRoseyID(roseyId)}
      set:html={md.render(content)}
    />
  )
}
